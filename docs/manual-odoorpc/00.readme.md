### odoorpc 介绍

1. 访问 odoo
2. 封装常用的 odoo jsonrpc 接口, 便于直接使用
3. 封装一个 Model Class, 实现对 odoo model 的所有操作
4. 可继承 Model Class, 自定义 model

### odoorpc 基本使用方法

#### 连接 odoo

```
import { ODOO } from '@/odoorpc'
const baseURL = 'http://your_odoo_server:8069'
const api = new ODOO({ baseURL })

const test_connect_odoo = async ()=>{
    const version_info = await api.get_version_info()
    console.log( version_info )
}

```

1. 下载 odoorpc, 复制到自己的项目中
2. baseURL 定义 服务器的地址
3. 导入 odoorpc 中的 ODOO 类
4. 创建 服务器连接 api
5. api 是一个对象, 是 odoorpc 的使用入口
6. 异步函数 get_version_info 是一个接口, 获取 odoo 的版本信息
7. get_version_info 返回的结果

```
  {
    server_version: '13.0-20200908',
    server_version_info: [13, 0, 0, 'final', 0, ''],
    server_serie: '13.0',
    protocol_version: 1
  }
```

#### 登录 odoo

```
const test_login = async ()=>{
    const db = 'your_database_name'
    const login = 'your_user_name'
    const password = 'your_password'
    const result = await api.login({db, login, password})
    console.log( result )
    const session_info = api.session_info
    console.log( result )
}

```

1. 异步函数 api.login 是一个接口, 验证用户身份
2. 如果验证通过, 返回 true
3. 如果验证不通过, 抛出异常, 可以通过 try catch 捕捉异常. 查看验证不通过的原因

#### 使用 Model

```
const test_model = async ()=>{
    const model_name = 'res.partner'
    const Partner_Model = api.env.model(model_name)
    const result = await Partner_Model.search([], {limit:10})
}

```

1. api.env.model 是一个接口, 获取一个 Model Class
2. Model.search 是一个异步模型方法, 搜索满足条件的记录的 id
3. Model.search 返回一个数组, 满足条件的记录的 所有 id

#### Model 模型基本方法

1. 以下这些方法是 Model 的基本模型方法
2. 都是 静态异步方法, 这些方法都是直接访问接口, 从服务端获取数据
3. 如果你对 odoo 非常熟悉. 那么很容易理解, 直接使用即可.
4. 如果你对 odoo 一般了解. 后文有专门介绍这些方法如何使用.
5. read(ids, {fields: ['name']})
6. search_read({domain: [], fields: ['name']})
7. execute_kw(method, args = [], kwargs = {})
8. execute(method, ...args)
9. fields_get(allfields, attributes)
10. write(rid, vals)
11. create(vals)
12. unlink(rid)
13. name_search({name, args, operator, limit})
14. name_get(ids)
15. onchange(ids, values, field_name, field_onchange)

#### Model 模型扩展方法

1. 以下这些方法是 Model 中基本方法之外的扩展方法, 便于操作数据
2. 关于这些扩展方法的详细使用, 后文有专门介绍
3. create_record({fields})
4. browse(ids, {fields})
5. search_browse({fields})
6. pageGoto(page = 1)
7. get_selection(field_name, {})
8. relation_browse(field_name, {fields})
9. new_and_onchange({})
10. set_and_onchange({})
11. commit()
12. refresh()
13. rollback()
14. pick(id)
15. tree_pick(id)
16. tree_new({})
17. tree_remove(id)
18. tree_update(id, {})
19. tree_rollback

### Model 类 介绍

1. 待完善
2. 包含一些基本方法, 用于直接访问服务器
3. 包含一些扩展方法, 以方便操作数据
4. Model 包含 三个子 Model
5. ListModel
6. FormModel
7. O2mTreeModel

### Model 扩展机制

1. 待完善
2. 可以继承 Model, 自定义 新的 Model
3. 自定义的 子 Model 是 父 Model 的一个子类
4. 子 Model 中可以扩展自己的方法
