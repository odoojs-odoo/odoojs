## odooapi 基本使用方法

### 初始化, 登录, 注销

1. odooapi 已经集成 odoorpc
2. 导入 odooapi 后, 可以直接使用 odoorpc 中的功能

#### odooapi 的初始化

```
import api from '@/odooapi'
const baseURL = 'http://your_odoo_server:8069'
const timeout = 50000
api.init({ baseURL, timeout })
```

#### 测试连接 odoo

1. 确保在其他地方已经完成初始化.
   使用 odooapi 之前, 必须先初始化. 初始化只需要一次即可.
   其他接口的调用, 不再重复强调 必须先初始化.
2. 导入 odooapi
3. 调用异步接口函数, 发送请求, 返回数据

```
import api from '@/odooapi'
const test_connect_odoo = async ()=>{
    const version_info = await api.web.webclient.version_info()
    console.log( version_info )
}

```

#### 登录 odoo

1. 接口: api.web.login
2. 参数: db, login, password
3. 返回: {session, context, is_user, menus }

```
import api from '@/odooapi'
const test_login = async ()=>{
    const db = 'your_database_name'
    const login = 'your_user_name'
    const password = 'your_password'
    const login_info = await api.web.login({db, login, password})
    console.log( login_info )
}

```

##### 返回结果

```
{
    session: {},  // 内容参见 odoorpc
    context: {},  // 内容参见 odoorpc
    is_user: true, // 属于权限组 base.group_user
    menus: {}  // 参见 menu 接口说明
}
```

#### session_check

1. 接口: api.web.session_check
2. 参数: 无
3. 返回: 无
4. 前端初始化页面时, 需要检查 当前 session 是否有效

```
import api from '@/odooapi'
const test_session_check = async ()=>{
    await api.web.session_check()
}

```

#### 注销

1. 接口: api.web.logout
2. 参数: 无
3. 返回: 无

```
import api from '@/odooapi'
const test_logout = async ()=>{
    await api.web.logout()
}

```

### 使用 env 和 Model

```
import api from '@/odooapi'
const test_model = async ()=>{
    const model_name = 'res.partner'
    const Partner_Model = api.env.model(model_name)
    const result = await Partner_Model.search([], {limit:10})
}

```
