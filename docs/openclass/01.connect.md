## 课程目标

1. 掌握 odoo 的 JsonRpc 接口基本要求
2. 掌握 vue 前端项目如何访问 odoo 接口

## 进程

1. 准备工作, 创建 vue 项目
2. 启动 odoo 服务

### 准备工作

#### 创建 vue 项目

1. [参考文档]()
2. https://gitee.com/. 新建仓库, 注意不要初始化仓库
3. [创建 vue 项目](https://cli.vuejs.org/zh/guide/creating-a-project.html)
4. 运行项目

```
vue create odoojs-open
cd odoojs-open
git remote add origin https://gitee.com/<your-git-account>/<your-git-project>.git
git push -u origin master
tyarn
tyarn serve
```

#### 简单介绍下 vue 项目的结构

1. main.js
2. app.vue
3. components/HelloWorld.vue

#### 新建一个页面 Test0.vue 替换 HelloWorld.vue

1. 复制 HelloWorld.vue 命名为 Test0.vue
2. 修改 Test0.vue, 删除无关内容
3. 修改 App.vue 引入 Test0.vue
4. 运行项目, 查看效果

### 准备服务器

#### 启动服务端

1. 启动服务端
2. 查看 odoo 运行日志
3. 登录 8069 端口, 查看 odoo
4. 查看 odoo 服务端版本号
5. 运行日志第一行 显示 odoo 版本号
6. odoo 菜单->设置->关于. 显示版本号

#### 查看 odoo 源码

1. odoo.addons.web.main.py
2. WebClient.version_info

```
class WebClient(http.Controller):
    @http.route('/web/webclient/version_info', type='json', auth="none")
    def version_info(self):
        pass
```

#### 测试 odoo

1. 创建一个 html 文件. 内容如下
2. 浏览器中打开该文件
3. 打开浏览器开发者工具. 查看情况
4. 在服务端查看日志输出

```
<script type="text/javascript">
  const xml = new XMLHttpRequest()
  const url = 'http://192.168.56.108:8069/web/webclient/version_info'
  xml.open('POST', url, true)
  xml.send()
</script>

```

### 浏览器开发者工具

#### 打开 开发者工具

1. google chrome. 右上角菜单 -> 更多工具 -> 开发者工具 -> network
2. firefox . 右上角菜单 -> 更多工具 -> web 开发者工具 -> 网络 network
3. safari . 菜单 -> 开发 -> 显示页面检查器
4. 右键菜单 -> 检查 -> network

### 修改 Test0.vue, 测试请求

1. 添加按钮.
2. 按钮点击事件
3. 使用 XMLHttpRequest 发送请求
4. 确认服务端有响应. 看到跨域提示
5. 配置代理, 解决跨越
6. 请求成功
7. 代码规整为一个异步函数. 返回响应结果
8. 处理响应结果. 在页面上显示

### 使用 odoorpc

1. 复制 odoorpc 到项目中.
2. 依赖 axios. 安装 axios
3. 调用异步函数, 获取 odoo 版本号
4. 在页面上显示 odoo 版本号
