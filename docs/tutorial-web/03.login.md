### 使用 view-desige

#### 安装 view-desige

```
tyarn add view-design
```

#### 编辑 main.js

```
import ViewUI from 'view-design'
import 'view-design/dist/styles/iview.css'
Vue.use(ViewUI)

```

### 登录页面

#### 登录页面样式

![登录页面](https://gitee.com/odoowww/odoorpc-js-tutorial/raw/master/docs/tutorial-web/image/03.login.jpg '登录页面')

#### 编辑 views/user/index.vue

1. 做一个 form 表单
2. 三个输入项, 数据库, 用户账号, 密码
3. 数据库 使用 Select, 其他两个使用 Input
4. Select 的 options 数据, 需要远程获取
5. form 表单提交按钮, 发送登录请求
6. 登录成功跳转到主页面
7. 登录不成功(用户名或密码错), 弹框提示错误消息

### 主页面

#### 主页样式

![主页面](https://gitee.com/odoowww/odoorpc-js-tutorial/raw/master/docs/tutorial-web/image/03.home.jpg '主页面')

#### 编辑 views/home/index.vue

1. 登录成功后, api.session_info 中有当前登录用户的信息
2. 在主页上显示当前登录用户的信息
3. 点击注销按钮, 发送请求, 注销. 跳转到登录页面

### 页面跳转 及 页面刷新

#### 页面跳转

1. 在做页面跳转时, 跳转到新页面, 要发送请求获取数据
2. 此时, 若服务端 session 超期, 则新页面无法获取到数据
3. 因此, 在跳转之前, 需要先发送一个 check 请求

#### 页面刷新

1. 主页面刷新后, 页面上当前登录用户的信息丢失
2. 这时, 浏览器的 cookie 是存在的, 服务端的 Session 也未超期
3. 只是, 我们在刷新页面后, api 里的信息丢失
4. 因此, 在刷新页面后, 需要先发送请求, 获取 session_info

#### 编辑 main.js

```
import api from '@/api'

router.beforeEach(async (to, from, next) => {
  const whiteList = ['/user/login']
  if (whiteList.includes(to.path)) {
    next()
  } else {
    const hasToken = await api.session_check()
    if (hasToken) {
      next()
    } else {
      next(`/user/login?redirect=${to.path}`)
    }
  }
})

router.afterEach(() => {})

```
