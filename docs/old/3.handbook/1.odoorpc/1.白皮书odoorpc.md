## odoorpc

### odoorpc 介绍

1. 访问 odoo
2. 封装常用的 odoo jsonrpc 接口, 便于直接使用
3. 封装一个 Model Class, 实现对 odoo model 的所有操作
4. 可继承 Model Class, 自定义 model

### 对外接口规范

1. odoorpc 单独一个文件夹.
2. 使用时需要导入. import api from '@/odoorpc'
3. odoo 官方对外的 jsonrpc 接口, 在 odoorpc 中均有对应接口函数
4. 如版本信息接口是 '/web/webclient/version_info'
5. odoorpc 中对应有的接口函数 web.webclient.version_info
6. 调用接口: await api.web.webclient.version_info()
7. 简言之, 每一个接口都是一个异步函数. 调用接口就是调用函数

### 几个重要接口

1. 这些接口的功能, 参考 odoo 官方接口
2. 在使用手册中, 有例子介绍一些接口的使用方法

| 接口                           | 功能                           | 说明 |
| ------------------------------ | ------------------------------ | ---- |
| web.webclient.version_info     | odoo 版本                      |
|                                |
| web.session.authenticate       | 授权                           |
| web.session.check              | 检查 <br/>Session 是否超期     |      |
| web.session.destroy            | 注销                           |
| web.session.change_password    | 修改密码                       |
| web.login                      | 登录                           |
| web.logout                     | 注销                           |
|                                |                                |
| web.dataset.call_kw            | 调用模型方法                   |
| web.dataset.call_button        | 调用模型方法                   |
|                                |                                |
| web.action.load                | 获取 Action 信息               |
| web.action.run                 | 运行 Action                    |
|                                |
| report.check_wkhtmltopdf       | 检查 <br/>wkhtmltopdf 是否安装 |
| report.download                | 下载 pdf 报表文件              |
|                                |
| report.check_wkhtmltopdf       | 检查 <br/>wkhtmltopdf 是否安装 |
| report.download                | 下载 pdf 报表文件              |
|                                |
| web.export.xlsx                | 导出 excel 格式数据            |
| web.export.csv                 | 导出 csv 格式数据              |
| web.binary.upload_attachment   | 上传附件                       |
| web_editor.attachment.add_data | 富文本编辑, 上传附件           |
|                                |
|                                |
| web.database.create            | 创建数据库                     |
| web.database.drop              | 删除数据库                     |

### odoorpc 的初始化

1. 使用 odoorpc 之前, 需要初始化两个参数, baseURL 和 timeout
2. odoorpc 导入. import api from '@/odoorpc'
3. odoorpc 初始化. api.init({ baseURL, timeout })
4. 初始化函数 全局只调用一次即可

## Model

### Model 的使用

1. 接口 web.dataset.call_kw. 作用是调用模型方法
2. 参数为 model, method, args, kwargs
3. 调用该接口略显繁琐
4. 定义 Model 机制. 简化模型方法的调用

```
// 获取 Model:
const Model = api.env.model(model_name, context={})
// 调用模型方法:
await Model.method_name(...args)
```

### 常用模型方法

| 方法名          | 参数                                   | 返回值            |
| --------------- | -------------------------------------- | ----------------- |
| execute_kw      | method, args, kwargs                   |
| execute         | method, ...args                        |
| search          | domain, {limit, offset, order}         | ids               |
| search_read     | {domain, fields, limit, offset, order} | records           |
| web_search_read | {domain, fields, limit, offset, order} | {length, records} |
| read            | ids/id, {fields}                       | records           |
| create          | vals                                   | id                |
| write           | id, vals                               | true/false        |
| unlink          | id                                     | true/false        |

### Model 扩展机制

1. 可以继承 Model, 自定义 新的 Model
2. 在新的 Model 中可以扩展自己的方法

## session

### session

### context

### cookie

## 多公司

## many2one

## selection

## many2many

## one2many

## file
